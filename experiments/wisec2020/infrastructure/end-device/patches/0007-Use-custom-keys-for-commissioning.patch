From e185352be654d7b543ae1fd396d398e664c1482b Mon Sep 17 00:00:00 2001
From: Frank Hessel <frank@fhessel.de>
Date: Thu, 23 Jan 2020 11:25:17 +0100
Subject: [PATCH 07/14] Use custom keys for commissioning

---
 .../LoRaMac/classA/NucleoL476/Commissioning.h | 19 ++++++++++---------
 .../LoRaMac/classB/NucleoL476/Commissioning.h | 19 ++++++++++---------
 2 files changed, 20 insertions(+), 18 deletions(-)

diff --git a/src/apps/LoRaMac/classA/NucleoL476/Commissioning.h b/src/apps/LoRaMac/classA/NucleoL476/Commissioning.h
index 7f71b362..b1254f05 100644
--- a/src/apps/LoRaMac/classA/NucleoL476/Commissioning.h
+++ b/src/apps/LoRaMac/classA/NucleoL476/Commissioning.h
@@ -87,7 +87,8 @@
  * \remark In this application the value is automatically generated by calling
  *         BoardGetUniqueId function
  */
-#define LORAWAN_DEVICE_EUI                                 { IEEE_OUI, 0x00, 0x00, 0x00, 0x00, 0x00 }
+//#define LORAWAN_DEVICE_EUI                                 { IEEE_OUI, 0x00, 0x00, 0x00, 0x00, 0x00 }
+#define LORAWAN_DEVICE_EUI { 0x6b, 0x9c, 0x65, 0xe7, 0x7a, 0x58, 0xbc, 0xa8 }
 
 /*!
  * App/Join server IEEE EUI (big endian)
@@ -98,19 +99,19 @@
  * Application root key
  * WARNING: NOT USED FOR 1.0.x DEVICES
  */
-#define LORAWAN_APP_KEY                                    { 0x2B, 0x7E, 0x15, 0x16, 0x28, 0xAE, 0xD2, 0xA6, 0xAB, 0xF7, 0x15, 0x88, 0x09, 0xCF, 0x4F, 0x3C }
+#define LORAWAN_APP_KEY                                    { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }
 
 /*!
  * Application root key - Used to derive Multicast keys on 1.0.x devices.
  * WARNING: USED only FOR 1.0.x DEVICES
  */
-#define LORAWAN_GEN_APP_KEY                                { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F }
+#define LORAWAN_GEN_APP_KEY                                { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }
 
 /*!
  * Network root key
  * WARNING: FOR 1.0.x DEVICES IT IS THE \ref LORAWAN_APP_KEY
  */
-#define LORAWAN_NWK_KEY                                    { 0x2B, 0x7E, 0x15, 0x16, 0x28, 0xAE, 0xD2, 0xA6, 0xAB, 0xF7, 0x15, 0x88, 0x09, 0xCF, 0x4F, 0x3C }
+#define LORAWAN_NWK_KEY                                    { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }
 
 /*!
  * Current network ID
@@ -124,29 +125,29 @@
  *         a pseudo random generator seeded with a value derived from
  *         BoardUniqueId value if LORAWAN_DEVICE_ADDRESS is set to 0
  */
-#define LORAWAN_DEVICE_ADDRESS                             ( uint32_t )0x00000000
+#define LORAWAN_DEVICE_ADDRESS                             ( uint32_t )0x012fb087
 
 /*!
  * Forwarding Network session integrity key
  * WARNING: NWK_S_KEY FOR 1.0.x DEVICES
  */
-#define LORAWAN_F_NWK_S_INT_KEY                            { 0x2B, 0x7E, 0x15, 0x16, 0x28, 0xAE, 0xD2, 0xA6, 0xAB, 0xF7, 0x15, 0x88, 0x09, 0xCF, 0x4F, 0x3C }
+#define LORAWAN_F_NWK_S_INT_KEY                            { 0xad, 0x34, 0x4a, 0x45, 0xc0, 0xce, 0x20, 0x0e, 0x4d, 0x1a, 0x46, 0x06, 0xb0, 0x09, 0xe5, 0x94 }
 
 /*!
  * Serving Network session integrity key
  * WARNING: NOT USED FOR 1.0.x DEVICES. MUST BE THE SAME AS \ref LORAWAN_F_NWK_S_INT_KEY
  */
-#define LORAWAN_S_NWK_S_INT_KEY                            { 0x2B, 0x7E, 0x15, 0x16, 0x28, 0xAE, 0xD2, 0xA6, 0xAB, 0xF7, 0x15, 0x88, 0x09, 0xCF, 0x4F, 0x3C }
+#define LORAWAN_S_NWK_S_INT_KEY                            { 0xaa, 0xed, 0x6a, 0x08, 0x9c, 0x2a, 0xa5, 0x60, 0xcb, 0x42, 0xbe, 0xe3, 0xbd, 0x47, 0x39, 0xf7 }
 
 /*!
  * Network session encryption key
  * WARNING: NOT USED FOR 1.0.x DEVICES. MUST BE THE SAME AS \ref LORAWAN_F_NWK_S_INT_KEY
  */
-#define LORAWAN_NWK_S_ENC_KEY                              { 0x2B, 0x7E, 0x15, 0x16, 0x28, 0xAE, 0xD2, 0xA6, 0xAB, 0xF7, 0x15, 0x88, 0x09, 0xCF, 0x4F, 0x3C }
+#define LORAWAN_NWK_S_ENC_KEY                              { 0x96, 0xe6, 0xa6, 0x67, 0x2f, 0x12, 0x24, 0xb9, 0xbd, 0xfc, 0xb4, 0xf5, 0x0d, 0x3c, 0xeb, 0x34 }
 
 /*!
  * Application session key
  */
-#define LORAWAN_APP_S_KEY                                  { 0x2B, 0x7E, 0x15, 0x16, 0x28, 0xAE, 0xD2, 0xA6, 0xAB, 0xF7, 0x15, 0x88, 0x09, 0xCF, 0x4F, 0x3C }
+#define LORAWAN_APP_S_KEY                                  { 0xb8, 0xdb, 0x43, 0xad, 0xa7, 0x6c, 0xfe, 0xaa, 0x1d, 0xdc, 0xe4, 0x67, 0xa6, 0x5a, 0x70, 0x58 }
 
 #endif // __LORA_COMMISSIONING_H__
diff --git a/src/apps/LoRaMac/classB/NucleoL476/Commissioning.h b/src/apps/LoRaMac/classB/NucleoL476/Commissioning.h
index 7f71b362..6436e97a 100644
--- a/src/apps/LoRaMac/classB/NucleoL476/Commissioning.h
+++ b/src/apps/LoRaMac/classB/NucleoL476/Commissioning.h
@@ -87,7 +87,8 @@
  * \remark In this application the value is automatically generated by calling
  *         BoardGetUniqueId function
  */
-#define LORAWAN_DEVICE_EUI                                 { IEEE_OUI, 0x00, 0x00, 0x00, 0x00, 0x00 }
+//#define LORAWAN_DEVICE_EUI                                 { IEEE_OUI, 0x00, 0x00, 0x00, 0x00, 0x00 }
+#define LORAWAN_DEVICE_EUI { 0x6b, 0x9c, 0x65, 0xe7, 0x7a, 0x58, 0xbc, 0xa9 }
 
 /*!
  * App/Join server IEEE EUI (big endian)
@@ -98,19 +99,19 @@
  * Application root key
  * WARNING: NOT USED FOR 1.0.x DEVICES
  */
-#define LORAWAN_APP_KEY                                    { 0x2B, 0x7E, 0x15, 0x16, 0x28, 0xAE, 0xD2, 0xA6, 0xAB, 0xF7, 0x15, 0x88, 0x09, 0xCF, 0x4F, 0x3C }
+#define LORAWAN_APP_KEY                                    { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }
 
 /*!
  * Application root key - Used to derive Multicast keys on 1.0.x devices.
  * WARNING: USED only FOR 1.0.x DEVICES
  */
-#define LORAWAN_GEN_APP_KEY                                { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F }
+#define LORAWAN_GEN_APP_KEY                                { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }
 
 /*!
  * Network root key
  * WARNING: FOR 1.0.x DEVICES IT IS THE \ref LORAWAN_APP_KEY
  */
-#define LORAWAN_NWK_KEY                                    { 0x2B, 0x7E, 0x15, 0x16, 0x28, 0xAE, 0xD2, 0xA6, 0xAB, 0xF7, 0x15, 0x88, 0x09, 0xCF, 0x4F, 0x3C }
+#define LORAWAN_NWK_KEY                                    { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }
 
 /*!
  * Current network ID
@@ -124,29 +125,29 @@
  *         a pseudo random generator seeded with a value derived from
  *         BoardUniqueId value if LORAWAN_DEVICE_ADDRESS is set to 0
  */
-#define LORAWAN_DEVICE_ADDRESS                             ( uint32_t )0x00000000
+#define LORAWAN_DEVICE_ADDRESS                             ( uint32_t )0x012fb088
 
 /*!
  * Forwarding Network session integrity key
  * WARNING: NWK_S_KEY FOR 1.0.x DEVICES
  */
-#define LORAWAN_F_NWK_S_INT_KEY                            { 0x2B, 0x7E, 0x15, 0x16, 0x28, 0xAE, 0xD2, 0xA6, 0xAB, 0xF7, 0x15, 0x88, 0x09, 0xCF, 0x4F, 0x3C }
+#define LORAWAN_F_NWK_S_INT_KEY                            { 0xad, 0x34, 0x4a, 0x45, 0xc0, 0xce, 0x20, 0x0e, 0x4d, 0x1a, 0x46, 0x06, 0xb0, 0x09, 0xe5, 0x94 }
 
 /*!
  * Serving Network session integrity key
  * WARNING: NOT USED FOR 1.0.x DEVICES. MUST BE THE SAME AS \ref LORAWAN_F_NWK_S_INT_KEY
  */
-#define LORAWAN_S_NWK_S_INT_KEY                            { 0x2B, 0x7E, 0x15, 0x16, 0x28, 0xAE, 0xD2, 0xA6, 0xAB, 0xF7, 0x15, 0x88, 0x09, 0xCF, 0x4F, 0x3C }
+#define LORAWAN_S_NWK_S_INT_KEY                            { 0xaa, 0xed, 0x6a, 0x08, 0x9c, 0x2a, 0xa5, 0x60, 0xcb, 0x42, 0xbe, 0xe3, 0xbd, 0x47, 0x39, 0xf7 }
 
 /*!
  * Network session encryption key
  * WARNING: NOT USED FOR 1.0.x DEVICES. MUST BE THE SAME AS \ref LORAWAN_F_NWK_S_INT_KEY
  */
-#define LORAWAN_NWK_S_ENC_KEY                              { 0x2B, 0x7E, 0x15, 0x16, 0x28, 0xAE, 0xD2, 0xA6, 0xAB, 0xF7, 0x15, 0x88, 0x09, 0xCF, 0x4F, 0x3C }
+#define LORAWAN_NWK_S_ENC_KEY                              { 0x96, 0xe6, 0xa6, 0x67, 0x2f, 0x12, 0x24, 0xb9, 0xbd, 0xfc, 0xb4, 0xf5, 0x0d, 0x3c, 0xeb, 0x34 }
 
 /*!
  * Application session key
  */
-#define LORAWAN_APP_S_KEY                                  { 0x2B, 0x7E, 0x15, 0x16, 0x28, 0xAE, 0xD2, 0xA6, 0xAB, 0xF7, 0x15, 0x88, 0x09, 0xCF, 0x4F, 0x3C }
+#define LORAWAN_APP_S_KEY                                  { 0xb8, 0xdb, 0x43, 0xad, 0xa7, 0x6c, 0xfe, 0xaa, 0x1d, 0xdc, 0xe4, 0x67, 0xa6, 0x5a, 0x70, 0x58 }
 
 #endif // __LORA_COMMISSIONING_H__
-- 
2.20.1

